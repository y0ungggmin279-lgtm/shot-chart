<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shot Chart Pro</title>
    <style>
        /* Ïä§ÌÉÄÏùºÏùÄ ÎèôÏùºÌïòÍ≤å Ïú†ÏßÄ */
        :root { --app-orange: #FF9500; --app-bg: #F2F2F7; --card-bg: #FFFFFF; --text-primary: #000000; --text-secondary: #8E8E93; --separator: #C6C6C8; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--app-bg); color: var(--text-primary); margin: 0; padding: 0; padding-bottom: 100px; }
        header { background-color: rgba(255, 255, 255, 0.8); padding: 20px; text-align: center; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.1); backdrop-filter: saturate(180%) blur(20px); }
        header h1 { margin: 0; font-size: 18px; font-weight: 600; }
        .container { max-width: 600px; margin: 0 auto; padding: 16px; }
        .section-title { font-size: 13px; color: var(--text-secondary); text-transform: uppercase; margin: 24px 0 8px 16px; font-weight: 400; }
        .card-list { background: var(--card-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .zone-row { display: flex; flex-direction: column; padding: 16px; border-bottom: 1px solid var(--separator); }
        .zone-row:last-child { border-bottom: none; }
        .zone-name { font-size: 17px; font-weight: 600; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
        .zone-stats-display { font-size: 14px; color: var(--text-secondary); font-weight: normal; }
        .stepper-container { display: flex; justify-content: space-between; align-items: center; gap: 10px; }
        .stepper-group { flex: 1; display: flex; align-items: center; justify-content: space-between; background-color: #f2f2f7; border-radius: 8px; padding: 4px; }
        .stepper-label { font-size: 12px; color: var(--text-secondary); text-align: center; width: 100%; margin-bottom: 4px; }
        .control-wrapper { display: flex; flex-direction: column; flex: 1; }
        .stepper-btn { width: 32px; height: 32px; border-radius: 7px; border: none; background-color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 18px; color: var(--app-orange); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; }
        .stepper-btn:active { background-color: #e5e5ea; transform: scale(0.95); }
        .stepper-btn.minus { color: var(--text-secondary); }
        .stepper-value { font-size: 18px; font-weight: 600; width: 30px; text-align: center; }
        .is-made .stepper-value { color: var(--app-orange); }
        .bottom-action { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); padding: 16px; border-top: 1px solid rgba(0,0,0,0.1); display: flex; justify-content: center; z-index: 200; }
        .btn-primary { background-color: var(--app-orange); color: white; border: none; font-size: 17px; font-weight: 600; padding: 14px 20px; border-radius: 12px; width: 100%; max-width: 600px; cursor: pointer; }
        .btn-primary:active { opacity: 0.8; }
        #result-area { display: none; margin-top: 30px; background: var(--card-bg); border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        canvas { width: 100% !important; height: auto !important; border-radius: 8px; border: 1px solid #eee; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-item { text-align: center; background: #F9F9F9; padding: 10px; border-radius: 8px; }
        .stat-label { font-size: 12px; color: var(--text-secondary); display: block; }
        .stat-val { font-size: 18px; font-weight: 700; color: var(--text-primary); }
    </style>
</head>
<body>

<header>
    <h1>üèÄ Shot Chart Pro</h1>
</header>

<div class="container">
    <div class="section-title">3 Point Area</div>
    <div class="card-list" id="zone-list-3pt"></div>

    <div class="section-title">Mid-Range Area</div>
    <div class="card-list" id="zone-list-mid"></div>

    <div class="section-title">Paint & Inside</div>
    <div class="card-list" id="zone-list-paint"></div>

    <div id="result-area">
        <div class="stat-grid">
            <div class="stat-item"><span class="stat-label">FG%</span><span class="stat-val" id="res-fg">-</span></div>
            <div class="stat-item"><span class="stat-label">3P%</span><span class="stat-val" id="res-3p">-</span></div>
            <div class="stat-item"><span class="stat-label">eFG%</span><span class="stat-val" id="res-efg">-</span></div>
        </div>
        <canvas id="shotChart" width="500" height="470"></canvas>
    </div>
</div>

<div class="bottom-action">
    <button class="btn-primary" id="saveBtn" onclick="generateChartAndSave()">Ï∞®Ìä∏ ÎßåÎì§Í∏∞ & Ï†ÄÏû•</button>
</div>

<script>
    // ==========================================
    // ‚ö†Ô∏è Ï£ºÏùò: URL ÏñëÏ™ΩÏóê Îî∞Ïò¥Ìëú("")Í∞Ä Íº≠ ÏûàÏñ¥Ïïº Ìï©ÎãàÎã§!
    // ==========================================
    const SCRIPT_URL = ""; // ‚Üê ÏùºÎã® ÎπÑÏõåÎëêÏÑ∏Ïöî. ÌôîÎ©¥Ïù¥ Îú®ÎäîÏßÄ Î®ºÏ†Ä ÌôïÏù∏Ìï©ÎãàÎã§.

    const ZONES = [
        { key: "c3_l", name: "Ï¢åÏ∏° ÏΩîÎÑà 3Ï†ê", group: "3pt", nba: 38, x: 30, y: 420, is3p: true },
        { key: "w3_l", name: "Ï¢åÏ∏° Ïúô 3Ï†ê", group: "3pt", nba: 36, x: 70, y: 150, is3p: true },
        { key: "top3", name: "Ï§ëÏïô 3Ï†ê", group: "3pt", nba: 35, x: 250, y: 100, is3p: true },
        { key: "w3_r", name: "Ïö∞Ï∏° Ïúô 3Ï†ê", group: "3pt", nba: 36, x: 430, y: 150, is3p: true },
        { key: "c3_r", name: "Ïö∞Ï∏° ÏΩîÎÑà 3Ï†ê", group: "3pt", nba: 38, x: 470, y: 420, is3p: true },
        { key: "short_l", name: "Ï¢åÏ∏° Ïàè ÏΩîÎÑà", group: "mid", nba: 40, x: 80, y: 400, is3p: false },
        { key: "mid_l", name: "Ï¢åÏ∏° ÎØ∏Îìú", group: "mid", nba: 40, x: 100, y: 280, is3p: false },
        { key: "mid_c", name: "ÏûêÏú†Ìà¨ Î∂ÄÍ∑º", group: "mid", nba: 40, x: 250, y: 250, is3p: false },
        { key: "mid_r", name: "Ïö∞Ï∏° ÎØ∏Îìú", group: "mid", nba: 40, x: 400, y: 280, is3p: false },
        { key: "short_r", name: "Ïö∞Ï∏° Ïàè ÏΩîÎÑà", group: "mid", nba: 40, x: 420, y: 400, is3p: false },
        { key: "paint_l", name: "Ï¢åÏ∏° ÌéòÏù∏Ìä∏", group: "paint", nba: 42, x: 170, y: 400, is3p: false },
        { key: "paint_c", name: "Ï§ëÏïô ÌéòÏù∏Ìä∏", group: "paint", nba: 42, x: 250, y: 350, is3p: false },
        { key: "paint_r", name: "Ïö∞Ï∏° ÌéòÏù∏Ìä∏", group: "paint", nba: 42, x: 330, y: 400, is3p: false },
        { key: "ra", name: "Í≥®Î∞ë (RA)", group: "paint", nba: 65, x: 250, y: 420, is3p: false },
    ];

    const state = {};
    ZONES.forEach(z => { state[z.key] = { m: 0, a: 0 }; });

    function renderInputs() {
        ZONES.forEach(z => {
            const container = document.getElementById(`zone-list-${z.group}`);
            if(!container) return;
            const row = document.createElement("div");
            row.className = "zone-row";
            row.innerHTML = `
                <div class="zone-name">${z.name}<span class="zone-stats-display" id="disp_${z.key}">0/0 (0%)</span></div>
                <div class="stepper-container">
                    <div class="control-wrapper"><div class="stepper-label">ÏÑ±Í≥µ</div><div class="stepper-group is-made">
                        <button class="stepper-btn minus" onclick="updateState('${z.key}', 'm', -1)">‚àí</button>
                        <span class="stepper-value" id="val_${z.key}_m">0</span>
                        <button class="stepper-btn" onclick="updateState('${z.key}', 'm', 1)">+</button>
                    </div></div>
                    <div class="control-wrapper"><div class="stepper-label">ÏãúÎèÑ</div><div class="stepper-group">
                        <button class="stepper-btn minus" onclick="updateState('${z.key}', 'a', -1)">‚àí</button>
                        <span class="stepper-value" id="val_${z.key}_a">0</span>
                        <button class="stepper-btn" onclick="updateState('${z.key}', 'a', 1)">+</button>
                    </div></div>
                </div>`;
            container.appendChild(row);
        });
    }

    function updateState(key, type, delta) {
        const target = state[key];
        if (type === 'm') {
            const newM = target.m + delta;
            if (newM < 0) return;
            if (newM > target.a) target.a = newM; 
            target.m = newM;
        } else {
            const newA = target.a + delta;
            if (newA < 0) return;
            if (newA < target.m) return;
            target.a = newA;
        }
        document.getElementById(`val_${key}_m`).innerText = target.m;
        document.getElementById(`val_${key}_a`).innerText = target.a;
        const pct = target.a > 0 ? Math.round((target.m / target.a) * 100) : 0;
        document.getElementById(`disp_${key}`).innerText = `${target.m}/${target.a} (${pct}%)`;
    }

    function generateChartAndSave() {
        const btn = document.getElementById("saveBtn");
        const originalText = btn.innerText;
        
        let totalM = 0, totalA = 0, total3M = 0, total3A = 0;
        let payload = {};

        ZONES.forEach(z => {
            const s = state[z.key];
            totalM += s.m; totalA += s.a;
            if(z.is3p) { total3M += s.m; total3A += s.a; }
            payload[z.key + "_m"] = s.m; payload[z.key + "_a"] = s.a;
            z.userM = s.m; z.userA = s.a; z.userPct = s.a > 0 ? (s.m / s.a) * 100 : 0;
        });

        const fgPct = totalA > 0 ? (totalM/totalA)*100 : 0;
        const p3Pct = total3A > 0 ? (total3M/total3A)*100 : 0;
        const efgPct = totalA > 0 ? ((totalM + 0.5*total3M)/totalA)*100 : 0;

        document.getElementById("res-fg").innerText = `${fgPct.toFixed(1)}%`;
        document.getElementById("res-3p").innerText = `${p3Pct.toFixed(1)}%`;
        document.getElementById("res-efg").innerText = `${efgPct.toFixed(1)}%`;
        document.getElementById("result-area").style.display = "block";

        drawShotChart();
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

        payload.total_fgm = totalM; payload.total_fga = totalA;
        payload.total_fg_pct = fgPct.toFixed(1) + "%";
        payload.total_3pm = total3M; payload.total_3pa = total3A;
        payload.efg_pct = efgPct.toFixed(1) + "%";

        if(!SCRIPT_URL) {
            alert("Ï∞®Ìä∏Îäî ÏÉùÏÑ±ÎêòÏóàÏßÄÎßå Ï†ÄÏû•ÏùÄ Ïïà Îê©ÎãàÎã§.\nÏΩîÎìú ÏÉÅÎã® SCRIPT_URLÏóê Ï£ºÏÜåÎ•º ÎÑ£Ïñ¥Ï£ºÏÑ∏Ïöî.");
            return;
        }

        btn.innerText = "Ï†ÄÏû• Ï§ë...";
        btn.disabled = true;

        fetch(SCRIPT_URL, {
            method: "POST", mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        }).then(() => {
            alert("Ï†ÄÏû• ÏôÑÎ£å!");
            btn.innerText = "Ï†ÄÏû• ÏôÑÎ£å";
            setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 2000);
        }).catch(err => {
            alert("ÏóêÎü¨: " + err); btn.disabled = false;
        });
    }

    function drawShotChart() {
        const canvas = document.getElementById("shotChart");
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        ctx.lineWidth = 2; ctx.strokeStyle = "#D1D1D6";
        ctx.beginPath(); ctx.moveTo(30, 470); ctx.lineTo(30, 330);
        ctx.bezierCurveTo(30, 100, 470, 100, 470, 330); ctx.lineTo(470, 470); ctx.stroke();
        ctx.strokeRect(170, 280, 160, 190);
        ctx.beginPath(); ctx.arc(250, 415, 30, Math.PI, 0); ctx.stroke();
        ctx.beginPath(); ctx.arc(250, 415, 6, 0, 2*Math.PI); ctx.strokeStyle = "#FF9500"; ctx.lineWidth = 3; ctx.stroke();
        ctx.beginPath(); ctx.moveTo(220, 425); ctx.lineTo(280, 425); ctx.strokeStyle = "#555"; ctx.lineWidth = 2; ctx.stroke();

        ZONES.forEach(z => {
            if(z.userA === 0) return;
            let color = "#F1C40F";
            if (z.userPct >= z.nba + 10) color = "#2ECC71";
            else if (z.userPct <= z.nba - 10) color = "#FF3B30";
            ctx.beginPath(); ctx.arc(z.x, z.y, 24, 0, 2 * Math.PI); ctx.fillStyle = color; ctx.fill();
            ctx.strokeStyle = "white"; ctx.lineWidth = 2; ctx.stroke();
            ctx.fillStyle = "#fff"; ctx.font = "bold 11px sans-serif"; ctx.textAlign = "center";
            ctx.fillText(`${z.userM}/${z.userA}`, z.x, z.y - 2);
            ctx.fillText(`${Math.round(z.userPct)}%`, z.x, z.y + 11);
        });
    }

    renderInputs();
</script>
</body>
</html>
